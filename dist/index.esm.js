import e from"sfs-node";function r(e,r){try{var t=e()}catch(e){return r(e)}return t&&t.then?t.then(void 0,r):t}function t(t){var o=e({publicFolder:t.publicFolder,mask:t.mask,getFileById:t.getFileById,getFileByHash:t.getFileByHash,createFile:t.createFile,logger:t.logger}),n=o.resolveFilePath,i=o.urlToId,s=o.saveFile,l=o.deleteFileById;return{getFile:function(e,t){try{var o=e.protocol+"://"+e.get("host")+e.originalUrl,s=i(o);return Promise.resolve(r(function(){return Promise.resolve(n(s)).then(function(e){var r=e.filePath;t.setHeader("Content-Disposition",'inline; filename="'+e.fileName+'"'),t.status(200).sendFile(r)})},function(e){throw new Error(e)}))}catch(e){return Promise.reject(e)}},idToUrl:o.idToUrl,urlToId:i,saveFile:s,deleteFileByHash:o.deleteFileByHash,deleteFileById:l,deleteFile:function(e,t){try{return Promise.resolve(r(function(){var r=e.protocol+"://"+e.get("host")+e.originalUrl,o=i(r);return Promise.resolve(l(o)).then(function(){return t.status(200).send("ok")})},function(e){throw new Error(e)}))}catch(e){return Promise.reject(e)}},getDiskUsage:o.getDiskUsage,uploadFile:function(e,t,o){void 0===o&&(o={pathParamKey:"path",fileParamKey:"file"});try{if(!e.files)return Promise.resolve(t.status(400).send("Request doesn't contain any files"));var n=o.pathParamKey,i=o.fileParamKey;return Promise.resolve(r(function(){return console.log(e.files),Promise.resolve(s(e.files[i],e.body[n],o.optimisticId)).then(function(e){return t.status(200).send(e)})},function(e){throw new Error(e)}))}catch(e){return Promise.reject(e)}},uploadFiles:function(e,t,o){void 0===o&&(o={pathParamKey:"path"});try{if(!e.files)return Promise.resolve(t.status(400).send("Request doesn't contain any files"));var n=o.pathParamKey;return Promise.resolve(r(function(){var r=e.body[n],o=[];return Object.values(e.files).forEach(function(e){Array.isArray(e)?o.push.apply(o,e):o.push(e)}),Promise.resolve(Promise.all(o.map(function(e){return s(e,r)}))).then(function(e){return t.status(200).send(e)})},function(e){throw new Error(e)}))}catch(e){return Promise.reject(e)}}}}export{t as default};
//# sourceMappingURL=index.esm.js.map
